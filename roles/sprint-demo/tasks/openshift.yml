# plugin: community.kubernetes.openshift
# connections:
#   - host: "{{ SPRINT_DEMO_HUB_CLUSTER_API }}"
#     api_key: "{{ SPRINT_DEMO_HUB_CLUSTER_TOKEN }}"
#     verify_ssl: false


- name: Verify OpenShift connection
  command: 'hostname'
  register: output

- name: Verify oc connection
  command: 'oc cluster-info'
  register: output

- name: Query all pods in all RHACM namespaces
  command: 'oc get pods -n {{ item }}'
  with_items:
    - open-cluster-management
    - open-cluster-management-hub
    - open-cluster-management-issuer
    - open-cluster-management-agent
    - open-cluster-management-agent-addon
    - open-cluster-management-observability
    - open-cluster-management-addon-observability

- name: Query managed clusters
  command: 'oc get managedclusters -A'

- name: Get an existing Service object
  community.kubernetes.k8s_info:
    api_version: v1
    kind: Service
    name: acm-custom-registry
    namespace: open-cluster-management
  register: acr

- name: "k8s info kind:MultiClusterObservability name:observability"
  community.kubernetes.k8s_info:
    api_version: v1beta2
    kind: MultiClusterObservability
    name: observability
  register: mco
